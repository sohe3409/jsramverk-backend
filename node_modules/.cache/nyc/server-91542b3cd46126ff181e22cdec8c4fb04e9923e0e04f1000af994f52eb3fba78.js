"use strict";function cov_21rcbt9bay(){var path="C:\\cygwin64\\home\\sofia\\dbwebb-kurser\\jsramverk\\backend\\src\\server.js";var hash="03c7ab8a9098a3e3afeb07fb4dbc392e42f938db";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\cygwin64\\home\\sofia\\dbwebb-kurser\\jsramverk\\backend\\src\\server.js",statementMap:{"0":{start:{line:3,column:20},end:{line:3,column:50}},"1":{start:{line:4,column:17},end:{line:4,column:45}},"2":{start:{line:5,column:15},end:{line:5,column:44}},"3":{start:{line:6,column:17},end:{line:6,column:44}},"4":{start:{line:13,column:4},end:{line:27,column:5}},"5":{start:{line:14,column:8},end:{line:14,column:31}},"6":{start:{line:15,column:25},end:{line:15,column:44}},"7":{start:{line:16,column:21},end:{line:16,column:48}},"8":{start:{line:17,column:23},end:{line:17,column:34}},"9":{start:{line:18,column:8},end:{line:18,column:40}},"10":{start:{line:19,column:8},end:{line:19,column:28}},"11":{start:{line:21,column:8},end:{line:23,column:9}},"12":{start:{line:22,column:12},end:{line:22,column:40}},"13":{start:{line:25,column:8},end:{line:25,column:29}},"14":{start:{line:26,column:8},end:{line:26,column:22}},"15":{start:{line:33,column:4},end:{line:47,column:5}},"16":{start:{line:34,column:8},end:{line:34,column:31}},"17":{start:{line:35,column:25},end:{line:35,column:44}},"18":{start:{line:36,column:21},end:{line:36,column:48}},"19":{start:{line:37,column:23},end:{line:37,column:46}},"20":{start:{line:38,column:8},end:{line:38,column:40}},"21":{start:{line:39,column:8},end:{line:39,column:28}},"22":{start:{line:41,column:8},end:{line:43,column:9}},"23":{start:{line:42,column:12},end:{line:42,column:37}},"24":{start:{line:45,column:8},end:{line:45,column:29}},"25":{start:{line:46,column:8},end:{line:46,column:22}},"26":{start:{line:51,column:2},end:{line:65,column:3}},"27":{start:{line:52,column:6},end:{line:52,column:29}},"28":{start:{line:53,column:23},end:{line:53,column:42}},"29":{start:{line:54,column:19},end:{line:54,column:46}},"30":{start:{line:55,column:18},end:{line:58,column:7}},"31":{start:{line:59,column:21},end:{line:59,column:46}},"32":{start:{line:60,column:6},end:{line:62,column:8}},"33":{start:{line:64,column:6},end:{line:64,column:27}},"34":{start:{line:70,column:4},end:{line:95,column:5}},"35":{start:{line:71,column:8},end:{line:71,column:31}},"36":{start:{line:72,column:19},end:{line:72,column:38}},"37":{start:{line:73,column:21},end:{line:73,column:42}},"38":{start:{line:74,column:23},end:{line:74,column:44}},"39":{start:{line:75,column:24},end:{line:75,column:40}},"40":{start:{line:77,column:20},end:{line:82,column:9}},"41":{start:{line:84,column:23},end:{line:84,column:56}},"42":{start:{line:86,column:8},end:{line:92,column:9}},"43":{start:{line:87,column:12},end:{line:87,column:36}},"44":{start:{line:89,column:12},end:{line:91,column:14}},"45":{start:{line:94,column:8},end:{line:94,column:29}},"46":{start:{line:98,column:0},end:{line:103,column:2}}},fnMap:{"0":{name:"getDocs",decl:{start:{line:10,column:15},end:{line:10,column:22}},loc:{start:{line:10,column:25},end:{line:28,column:1}},line:10},"1":{name:"getDoc",decl:{start:{line:30,column:15},end:{line:30,column:21}},loc:{start:{line:30,column:26},end:{line:48,column:1}},line:30},"2":{name:"createDoc",decl:{start:{line:50,column:15},end:{line:50,column:24}},loc:{start:{line:50,column:31},end:{line:66,column:1}},line:50},"3":{name:"updateDoc",decl:{start:{line:69,column:15},end:{line:69,column:24}},loc:{start:{line:69,column:35},end:{line:96,column:1}},line:69}},branchMap:{"0":{loc:{start:{line:21,column:8},end:{line:23,column:9}},type:"if",locations:[{start:{line:21,column:8},end:{line:23,column:9}},{start:{line:21,column:8},end:{line:23,column:9}}],line:21},"1":{loc:{start:{line:41,column:8},end:{line:43,column:9}},type:"if",locations:[{start:{line:41,column:8},end:{line:43,column:9}},{start:{line:41,column:8},end:{line:43,column:9}}],line:41},"2":{loc:{start:{line:86,column:8},end:{line:92,column:9}},type:"if",locations:[{start:{line:86,column:8},end:{line:92,column:9}},{start:{line:86,column:8},end:{line:92,column:9}}],line:86}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"03c7ab8a9098a3e3afeb07fb4dbc392e42f938db"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_21rcbt9bay=function(){return actualCoverage;};}return actualCoverage;}cov_21rcbt9bay();const MongoClient=(cov_21rcbt9bay().s[0]++,require("mongodb").MongoClient);const database=(cov_21rcbt9bay().s[1]++,require("../db/database.js"));const client=(cov_21rcbt9bay().s[2]++,new MongoClient(database.uri));const ObjectId=(cov_21rcbt9bay().s[3]++,require("mongodb").ObjectId);async function getDocs(){cov_21rcbt9bay().f[0]++;let result;cov_21rcbt9bay().s[4]++;try{cov_21rcbt9bay().s[5]++;await client.connect();const database=(cov_21rcbt9bay().s[6]++,client.db("editor"));const docs=(cov_21rcbt9bay().s[7]++,database.collection("docs"));const cursor=(cov_21rcbt9bay().s[8]++,docs.find());cov_21rcbt9bay().s[9]++;result=await cursor.toArray();cov_21rcbt9bay().s[10]++;console.log(result);cov_21rcbt9bay().s[11]++;if((await cursor.count())===0){cov_21rcbt9bay().b[0][0]++;cov_21rcbt9bay().s[12]++;console.log("No documents");}else{cov_21rcbt9bay().b[0][1]++;}}finally{cov_21rcbt9bay().s[13]++;await client.close();cov_21rcbt9bay().s[14]++;return result;}}async function getDoc(id){cov_21rcbt9bay().f[1]++;let result;cov_21rcbt9bay().s[15]++;try{cov_21rcbt9bay().s[16]++;await client.connect();const database=(cov_21rcbt9bay().s[17]++,client.db("editor"));const docs=(cov_21rcbt9bay().s[18]++,database.collection("docs"));const cursor=(cov_21rcbt9bay().s[19]++,docs.find(ObjectId(id)));cov_21rcbt9bay().s[20]++;result=await cursor.toArray();cov_21rcbt9bay().s[21]++;console.log(result);cov_21rcbt9bay().s[22]++;if((await cursor.count())===0){cov_21rcbt9bay().b[1][0]++;cov_21rcbt9bay().s[23]++;console.log("Not found");}else{cov_21rcbt9bay().b[1][1]++;}}finally{cov_21rcbt9bay().s[24]++;await client.close();cov_21rcbt9bay().s[25]++;return result;}}async function createDoc(body){cov_21rcbt9bay().f[2]++;cov_21rcbt9bay().s[26]++;try{cov_21rcbt9bay().s[27]++;await client.connect();const database=(cov_21rcbt9bay().s[28]++,client.db("editor"));const docs=(cov_21rcbt9bay().s[29]++,database.collection("docs"));const doc=(cov_21rcbt9bay().s[30]++,{name:body.name,content:body.content});const result=(cov_21rcbt9bay().s[31]++,await docs.insertOne(doc));cov_21rcbt9bay().s[32]++;console.log(`A new document with _id: ${result.insertedId} was created.`);}finally{cov_21rcbt9bay().s[33]++;await client.close();}}async function updateDoc(id,body){cov_21rcbt9bay().f[3]++;cov_21rcbt9bay().s[34]++;try{cov_21rcbt9bay().s[35]++;await client.connect();const db=(cov_21rcbt9bay().s[36]++,client.db("editor"));const docs=(cov_21rcbt9bay().s[37]++,db.collection("docs"));const filter=(cov_21rcbt9bay().s[38]++,{_id:ObjectId(id)});const options=(cov_21rcbt9bay().s[39]++,{upsert:true});const doc=(cov_21rcbt9bay().s[40]++,{$set:{name:body.name,content:body.content}});const result=(cov_21rcbt9bay().s[41]++,await docs.updateOne(filter,doc));cov_21rcbt9bay().s[42]++;if(result.matchedCount==0){cov_21rcbt9bay().b[2][0]++;cov_21rcbt9bay().s[43]++;console.log("No match");}else{cov_21rcbt9bay().b[2][1]++;cov_21rcbt9bay().s[44]++;console.log(`${result.matchedCount} , updated ${result.modifiedCount}`);}}finally{cov_21rcbt9bay().s[45]++;await client.close();}}cov_21rcbt9bay().s[46]++;module.exports={getDocs,getDoc,createDoc,updateDoc};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJuYW1lcyI6WyJNb25nb0NsaWVudCIsInJlcXVpcmUiLCJkYXRhYmFzZSIsImNsaWVudCIsInVyaSIsIk9iamVjdElkIiwiZ2V0RG9jcyIsInJlc3VsdCIsImNvbm5lY3QiLCJkYiIsImRvY3MiLCJjb2xsZWN0aW9uIiwiY3Vyc29yIiwiZmluZCIsInRvQXJyYXkiLCJjb25zb2xlIiwibG9nIiwiY291bnQiLCJjbG9zZSIsImdldERvYyIsImlkIiwiY3JlYXRlRG9jIiwiYm9keSIsImRvYyIsIm5hbWUiLCJjb250ZW50IiwiaW5zZXJ0T25lIiwiaW5zZXJ0ZWRJZCIsInVwZGF0ZURvYyIsImZpbHRlciIsIl9pZCIsIm9wdGlvbnMiLCJ1cHNlcnQiLCIkc2V0IiwidXBkYXRlT25lIiwibWF0Y2hlZENvdW50IiwibW9kaWZpZWRDb3VudCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBLGEsNHFKQWVZOzJGQWJaLEtBQU1BLENBQUFBLFdBQVcsMEJBQUdDLE9BQU8sQ0FBQyxTQUFELENBQVAsQ0FBbUJELFdBQXRCLENBQWpCLENBQ0EsS0FBTUUsQ0FBQUEsUUFBUSwwQkFBR0QsT0FBTyxDQUFDLG1CQUFELENBQVYsQ0FBZCxDQUNBLEtBQU1FLENBQUFBLE1BQU0sMEJBQUcsR0FBSUgsQ0FBQUEsV0FBSixDQUFnQkUsUUFBUSxDQUFDRSxHQUF6QixDQUFILENBQVosQ0FDQSxLQUFNQyxDQUFBQSxRQUFRLDBCQUFHSixPQUFPLENBQUMsU0FBRCxDQUFQLENBQW1CSSxRQUF0QixDQUFkLENBSUEsY0FBZUMsQ0FBQUEsT0FBZixFQUF5Qix5QkFDckIsR0FBSUMsQ0FBQUEsTUFBSixDQURxQix3QkFHckIsR0FBSSx5QkFDQSxLQUFNSixDQUFBQSxNQUFNLENBQUNLLE9BQVAsRUFBTixDQUNBLEtBQU1OLENBQUFBLFFBQVEsMEJBQUdDLE1BQU0sQ0FBQ00sRUFBUCxDQUFVLFFBQVYsQ0FBSCxDQUFkLENBQ0EsS0FBTUMsQ0FB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QUFILENBQWMsTUFBZCxDQUFILENBQVYsQ0FDQSxLQUFNa0IsQ0FBQUEsTUFBTSwyQkFBRyxDQUFFQyxHQUFHLENBQUV6QixRQUFRLENBQUNlLEVBQUQsQ0FBZixDQUFILENBQVosQ0FDQSxLQUFNVyxDQUFBQSxPQUFPLDJCQUFHLENBQUVDLE1BQU0sQ0FBRSxJQUFWLENBQUgsQ0FBYixDQUVBLEtBQU1ULENBQUFBLEdBQUcsMkJBQUcsQ0FDUlUsSUFBSSxDQUFFLENBQ0ZULElBQUksQ0FBRUYsSUFBSSxDQUFDRSxJQURULENBRUZDLE9BQU8sQ0FBRUgsSUFBSSxDQUFDRyxPQUZaLENBREUsQ0FBSCxDQUFULENBT0EsS0FBTWxCLENBQUFBLE1BQU0sMkJBQUcsS0FBTUcsQ0FBQUEsSUFBSSxDQUFDd0IsU0FBTCxDQUFlTCxNQUFmLENBQXVCTixHQUF2QixDQUFULENBQVosQ0FkQSx5QkFnQkEsR0FBSWhCLE1BQU0sQ0FBQzRCLFlBQVAsRUFBdUIsQ0FBM0IsQ0FBOEIscURBQzFCcEIsT0FBTyxDQUFDQyxHQUFSLENBQVksVUFBWixFQUNILENBRkQsSUFFTyxxREFDSEQsT0FBTyxDQUFDQyxHQUFSLENBQ0ssR0FBRVQsTUFBTSxDQUFDNEIsWUFBYSxjQUFhNUIsTUFBTSxDQUFDNkIsYUFBYyxFQUQ3RCxFQUdILENBQ0osQ0F2QkQsT0F1QlUsMEJBQ04sS0FBTWpDLENBQUFBLE1BQU0sQ0FBQ2UsS0FBUCxFQUFOLENBQ0gsQ0FDSixDLHlCQUVEbUIsTUFBTSxDQUFDQyxPQUFQLENBQWlCLENBQ2JoQyxPQURhLENBRWJhLE1BRmEsQ0FHYkUsU0FIYSxDQUliTyxTQUphLENBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5jb25zdCBNb25nb0NsaWVudCA9IHJlcXVpcmUoXCJtb25nb2RiXCIpLk1vbmdvQ2xpZW50O1xyXG5jb25zdCBkYXRhYmFzZSA9IHJlcXVpcmUoXCIuLi9kYi9kYXRhYmFzZS5qc1wiKTtcclxuY29uc3QgY2xpZW50ID0gbmV3IE1vbmdvQ2xpZW50KGRhdGFiYXNlLnVyaSk7XHJcbmNvbnN0IE9iamVjdElkID0gcmVxdWlyZShcIm1vbmdvZGJcIikuT2JqZWN0SWQ7XHJcblxyXG5cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGdldERvY3MoKSB7XHJcbiAgICBsZXQgcmVzdWx0O1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgY2xpZW50LmNvbm5lY3QoKTtcclxuICAgICAgICBjb25zdCBkYXRhYmFzZSA9IGNsaWVudC5kYihcImVkaXRvclwiKTtcclxuICAgICAgICBjb25zdCBkb2NzID0gZGF0YWJhc2UuY29sbGVjdGlvbihcImRvY3NcIik7XHJcbiAgICAgICAgY29uc3QgY3Vyc29yID0gZG9jcy5maW5kKCk7XHJcbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgY3Vyc29yLnRvQXJyYXkoKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG5cclxuICAgICAgICBpZiAoKGF3YWl0IGN1cnNvci5jb3VudCgpKSA9PT0gMCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5vIGRvY3VtZW50c1wiKTtcclxuICAgICAgICB9XHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICAgIGF3YWl0IGNsaWVudC5jbG9zZSgpO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGdldERvYyhpZCkge1xyXG4gICAgbGV0IHJlc3VsdDtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGNsaWVudC5jb25uZWN0KCk7XHJcbiAgICAgICAgY29uc3QgZGF0YWJhc2UgPSBjbGllbnQuZGIoXCJlZGl0b3JcIik7XHJcbiAgICAgICAgY29uc3QgZG9jcyA9IGRhdGFiYXNlLmNvbGxlY3Rpb24oXCJkb2NzXCIpO1xyXG4gICAgICAgIGNvbnN0IGN1cnNvciA9IGRvY3MuZmluZChPYmplY3RJZChpZCkpO1xyXG4gICAgICAgIHJlc3VsdCA9IGF3YWl0IGN1cnNvci50b0FycmF5KCk7XHJcbiAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcclxuXHJcbiAgICAgICAgaWYgKChhd2FpdCBjdXJzb3IuY291bnQoKSkgPT09IDApIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJOb3QgZm91bmRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgICBhd2FpdCBjbGllbnQuY2xvc2UoKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVEb2MoYm9keSkge1xyXG4gIHRyeSB7XHJcbiAgICAgIGF3YWl0IGNsaWVudC5jb25uZWN0KCk7XHJcbiAgICAgIGNvbnN0IGRhdGFiYXNlID0gY2xpZW50LmRiKFwiZWRpdG9yXCIpO1xyXG4gICAgICBjb25zdCBkb2NzID0gZGF0YWJhc2UuY29sbGVjdGlvbihcImRvY3NcIik7XHJcbiAgICAgIGNvbnN0IGRvYyA9IHtcclxuICAgICAgICAgIG5hbWU6IGJvZHkubmFtZSxcclxuICAgICAgICAgIGNvbnRlbnQ6IGJvZHkuY29udGVudCxcclxuICAgICAgfTtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZG9jcy5pbnNlcnRPbmUoZG9jKTtcclxuICAgICAgY29uc29sZS5sb2coXHJcbiAgICAgICAgICBgQSBuZXcgZG9jdW1lbnQgd2l0aCBfaWQ6ICR7cmVzdWx0Lmluc2VydGVkSWR9IHdhcyBjcmVhdGVkLmBcclxuICAgICAgKTtcclxuICB9IGZpbmFsbHkge1xyXG4gICAgICBhd2FpdCBjbGllbnQuY2xvc2UoKTtcclxuICB9XHJcbn1cclxuXHJcblxyXG5hc3luYyBmdW5jdGlvbiB1cGRhdGVEb2MoaWQsIGJvZHkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgY2xpZW50LmNvbm5lY3QoKTtcclxuICAgICAgICBjb25zdCBkYiA9IGNsaWVudC5kYihcImVkaXRvclwiKTtcclxuICAgICAgICBjb25zdCBkb2NzID0gZGIuY29sbGVjdGlvbihcImRvY3NcIik7XHJcbiAgICAgICAgY29uc3QgZmlsdGVyID0geyBfaWQ6IE9iamVjdElkKGlkKSB9O1xyXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7IHVwc2VydDogdHJ1ZSB9O1xyXG5cclxuICAgICAgICBjb25zdCBkb2MgPSB7XHJcbiAgICAgICAgICAgICRzZXQ6IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IGJvZHkubmFtZSxcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGJvZHkuY29udGVudCxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkb2NzLnVwZGF0ZU9uZShmaWx0ZXIsIGRvYyk7XHJcblxyXG4gICAgICAgIGlmIChyZXN1bHQubWF0Y2hlZENvdW50ID09IDApIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJObyBtYXRjaFwiKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICAgICAgICAgIGAke3Jlc3VsdC5tYXRjaGVkQ291bnR9ICwgdXBkYXRlZCAke3Jlc3VsdC5tb2RpZmllZENvdW50fWBcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICAgIGF3YWl0IGNsaWVudC5jbG9zZSgpO1xyXG4gICAgfVxyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuICAgIGdldERvY3MsXHJcbiAgICBnZXREb2MsXHJcbiAgICBjcmVhdGVEb2MsXHJcbiAgICB1cGRhdGVEb2NcclxufTtcclxuIl19